## 1 项目概述

### 1.1 项目简介

微博客是一个轻量级的博客项目，项目采用前后端分离开发模式，主要练习前端开发和后端的CURD操作

![image-20230628203120590](img\image-20230628203120590.png)



### 1.2 功能描述

前台：

* 分类列表
* 文章列表

后台：

* 登录和注册

* 文章管理（列表、添加、修改、删除）
* 分类管理（列表、添加、修改、删除）

* 用户中心（查看和修改）



### 1.3 技术描述

* 项目采用前后端分离开发模块，包含前端和后端技术
* 后端技术：SpringBoot、MyBatis、MySQL、Maven、Swagger

* 前端技术：Vue3、ES6、Element Plus、npm



## 2 前后端分离开发

### 2.1 什么是前后端分离开发

前后端分离开发，就是在项目开发过程中，对于前端的代码专门由前端的开发人员开发，后端代码由后端人员负责，这样可以做到分工明确、各司其职，进而提高开发效率，前后端代码并行开发，加快项目的开发进度。目前前后端分离被各大公司使用，成为项目开发的主流开发方式。前后端分离开发后，工程结构也会发生变化，即前后端代码不会混在同一个maven工程中，而是分为前端工程和后端工程。

在美国等互联网环境比较发达的国家项目开发的分工协作更为明确，整个项目开发分为前端、中间层和后端三个开发阶段，这三个阶段分别由三个或者更多的人来协同完成。国内的大部分互联网公司只有前端工程师和后端工程师，中间层的工作有的由前端来完成，有的由后端来完成。



### 2.2 开发流程介绍

![image-20230311092005782](img\前后端分离开发.png)

前后端分离开发过程中，前端人员和后端人员要进行配合来共同完成一个任务。这个时候需要使用到接口。
接口（API接口）：是一个http的请求地址，主要是定义：请求路径、请求方式、请求参数、响应数据等内容。
（1）后端编写和维护接口文档，在 API 变化时更新接口文档
（2）后端根据接口文档进行接口开发
（3）前端根据接口文档进行开发
（4）开发完成后联调和提交测试

后端开发人员为前端提供接口的同时，还需同时提供接口的说明文档。但我们的代码总是会根据实际情况来实时更新，这个时候有可能会忘记更新接口的说明文档，造成一些不必要的问题。我们可以通过一些工具生成接口文档，做到文档实时更新。**Swagger** 是一个规范和完整的框架，用于生成、描述、调用和可视化 RESTful 风格的 Web 服务的接口文档。



## 3 搭建前端环境

### 3.1 准备工作

#### （1）安装Nodejs

#### （2）安装VS Code

### 3.2 初始化VUE项目

####  （1）使用Vite开启Vue3项目

Vite是一个web开发构建工具。

在命令行窗口里，执行npm create vite@latest，就可以初始化一个VUE项目。

在Project name这一行，输入项目名字，例如：learn-vue3。

在Select a framework这一行，选择Vue。

在Select a variant这一行，选择JavaScript。

![image-20230628161326058](img\image-20230628161326058.png)

#### （2）查看项目目录结构

![image-20230628161558697](img\image-20230628161558697.png)

#### （3）安装依赖

在项目目录下，执行npm install 命令，来进行依赖的安装。依赖安装完成后，会在目录下生成一个node_modules目录以及package-lock.json文件。
![image-20230628161737582](img\image-20230628161737582.png)

#### （4）启动项目

执行 npm run dev 命令来启动项目

![image-20230628161840624](img\image-20230628161840624.png)

**查看页面效果：**

![image-20230628162007292](img\image-20230628162007292.png)

### 3.3 安装相关插件和依赖

#### （1）修改package.json文件

```json
{
  "name": "blog-vue-project",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "@wangeditor/editor-for-vue": "^5.1.12",
    "axios": "^0.27.2",
    "element-plus": "^2.3.7",
    "js-cookie": "^3.0.5",
    "pinia": "^2.0.16",
    "sass": "^1.53.0",
    "vue": "^3.2.37",
    "vue-router": "^4.1.2"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^3.0.0",
    "naive-ui": "^2.31.0",
    "unplugin-auto-import": "^0.16.4",
    "unplugin-vue-components": "^0.25.1",
    "vfonts": "^0.0.3",
    "vite": "^3.0.0"
  }
}
```

#### （2）执行npm install下载安装

![image-20230628163337976](img\image-20230628163337976.png)

#### （3）修改vite.config.js文件

```js
import { fileURLToPath, URL } from 'node:url'
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'
 
// https://vitejs.dev/config/
export default defineConfig({
  base: "./",
  plugins: [
    vue(),
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    }
  }
})
```

#### （4）修改src下main.js

```js
import { createApp } from 'vue'
import './style.css'
import App from './App.vue'
import naive from 'naive-ui'
import { createDiscreteApi } from 'naive-ui'
import { router } from './common/router'
import { createPinia } from "pinia";
import axios from 'axios'

import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'

import './assets/style.css'

// 服务端地址
axios.defaults.baseURL = "http://localhost:8080"
// 独立API
const { message, notification, dialog } = createDiscreteApi(["message", "dialog", "notification"])


const app = createApp(App)

// 全局提供属性
app.provide("axios", axios)
app.provide("message", message)
app.provide("notification", notification)
app.provide("dialog", dialog)
app.provide("server_url", axios.defaults.baseURL )

app.use(naive)
app.use(createPinia());
app.use(router);
app.use(ElementPlus);

app.mount('#app')
```

### 3.4 创建路由

#### （1）创建router.js文件

![image-20230628164057152](img\image-20230628164057152.png)

```js
import { createRouter, createWebHashHistory } from "vue-router";

let routes = [
    //{ path: "/test", component: () => import("../views/Test.vue") },
    { path: "/", component: () => import("../views/HomePage.vue") },
    { path: "/detail", component: () => import("../views/Detail.vue") },
    { path: "/login", component: () => import("../views/Login.vue") },
    //{ path: "/register", component: () => import("../views/Register.vue") },
    {
        path: "/dashboard", component: () => import("../views/dashboard/Dashboard.vue"), children: [
            { path: "/dashboard/category", component: () => import("../views/dashboard/Category.vue") },
            { path: "/dashboard/article", component: () => import("../views/dashboard/Article.vue") },
            { path: "/dashboard/user", component: () => import("../views/dashboard/User.vue") },
        ]
    },
]

const router = createRouter({
    history: createWebHashHistory(),
    routes,
});

export { router, routes };
```



### 3.5 封装axios

#### （1）创建axios.js

在src下创建文件夹utils，在utils下创建axios.js

![image-20230628164257882](img\image-20230628164257882.png)

```js
import axios from "axios";
// 使用element-plus ElMessage做消息提醒
import { ElMessage } from 'element-plus'

import cookie from 'js-cookie'

//1. 创建新的axios实例，
const service = axios.create({
  // 公共接口 开发环境还是线上环境也可以用api
  baseURL:"http://localhost:8001",
  // 超时时间 单位是ms，这里设置了5s的超时时间
  timeout: 50000,
});
// 2.请求拦截器
service.interceptors.request.use(
  (config) => {
    //发请求前做的一些处理，数据转化，配置请求头，设置token,设置loading等，根据需求去添加
    //  config.data = qs.stringify(config.data); //数据转化,也可以使用qs转换
    //  config.headers = {
    //    'Content-Type':'application/x-www-form-urlencoded' //配置请求头
    //  }
    //注意使用token的时候需要引入cookie方法或者用本地localStorage等方法，推荐js-cookie
    //  const token = getCookie('名称');//这里取token之前，你肯定需要先拿到token,存一下
    //  if(token){
    //     config.params = {'token':token} //如果要求携带在参数中
    //     config.headers.token= token; //如果要求携带在请求头中
    //   }
    // config.method === "post"
    //   ? (config.data = qs.stringify({ ...config.data }))
    //   : (config.params = { ...config.params });
    return config;
  },
  (error) => {
    Promise.reject(error);
  }
);

// 3.响应拦截器
service.interceptors.response.use(
  (response) => {
    if (response.data.code !== 200) {
      ElMessage.error(response.data.message);
      return Promise.resolve(error.response);
    } else {
        return response.data
    }
  },
  (error) => {
    /***** 接收到异常响应的处理开始 *****/
    ElMessage.error("连接服务器失败");
    //ElMessage.error(ElMessage.error)
    /***** 处理结束 *****/
    //如果不需要错误处理，以上的处理过程都可省略
    return Promise.resolve(error.response);
  }
);
//4.导出
export default service;
```

#### （2）创建定义接口信息js文件

在src下创建文件夹api，在api下创建js文件定义接口信息

![image-20230628164518828](img\image-20230628164518828.png)

```js
import request from '../utils/axios.js'

// 编写示例
export const test = (data) => {
    return request({
        url: `/user/test`,
        method: 'post',
        data: data
    })
}
```



### 3.6 整合富文本编辑器

在components文件夹下创建RichTextEditor.vue文件

![image-20230628165031145](img\image-20230628165031145.png)

```vue
<!-- 富文本组件 -->
<template>
    <div>
        <Toolbar :editor="editorRef" :defaultConfig="toolbarConfig" :mode="mode"
            style="border-bottom: 1px solid #ccc" />
        <Editor :defaultConfig="editorConfig" :mode="mode" v-model="valueHtml" style="height: 400px; overflow-y: hidden"
            @onCreated="handleCreated" @onChange="handleChange" />
    </div>
</template>

<script setup>
import '@wangeditor/editor/dist/css/style.css';
import { ref, reactive, inject, onMounted, onBeforeUnmount, shallowRef } from 'vue'
import { Editor, Toolbar } from '@wangeditor/editor-for-vue';

const server_url = inject("server_url")
// 编辑器实例，必须用 shallowRef，重要！
const editorRef = shallowRef();
const toolbarConfig = { excludeKeys:["uploadVideo"] };
const editorConfig = { placeholder: '请输入内容...' };
editorConfig.MENU_CONF = {}
editorConfig.MENU_CONF['uploadImage'] = {
    base64LimitSize: 10 * 1024, // 10kb
    server: server_url+'/upload/rich_editor_upload',
}
editorConfig.MENU_CONF['insertImage'] ={
    parseImageSrc:(src) =>{
        if(src.indexOf("http") !==0){
            return `${server_url}${src}`
        }
        return src
    }
}

const mode = ref("default")
const valueHtml = ref("")

const props = defineProps({
    modelValue: {
        type: String,
        default: ""
    }
})

const emit = defineEmits(["update:model-value"])
let initFinished = false

onMounted(() => {
    setTimeout(() => {
        valueHtml.value = props.modelValue;
        initFinished = true;
    }, 10);
});

// 组件销毁时，也及时销毁编辑器，重要！
onBeforeUnmount(() => {
    const editor = editorRef.value;
    if (editor == null) return;
    editor.destroy();
});

// 编辑器回调函数
const handleCreated = (editor) => {
    console.log('created', editor);
    editorRef.value = editor; // 记录 editor 实例，重要！
};
const handleChange = (editor) => {
    if (initFinished) {
        emit("update:model-value", valueHtml.value)
    }
};

</script>

<style lang="scss" scoped>
</style>
```



### 3.7 修改文件

#### （1）修改app.vue

```vue
<template>
  <router-view></router-view>
</template>

<script setup>
</script>

<style scoped>
</style>
```

#### （2）修改style.css

```css
body {
  margin: 0;
  padding: 0;
}
```



### 3.8 创建路由对应的vue文件

#### 3.8.1 复制需要的图片和样式

复制到assets目录下

![image-20230628170622597](img\image-20230628170622597.png)

#### 3.8.2 创建vue页面

**在src下创建views文件夹，在views文件夹下创建对应的vue文件**

![image-20230628165528195](img\image-20230628165528195.png)

#### （1）HomePage.vue

**是项目前台的首页面**

**对应路由：**{ path: "/", component: () => import("../views/HomePage.vue") }, 

```vue
<template>
    <div>
      <header id="header-menu" class="sticky top-0 z-10 flex h-14 bg-white py-3 menu-sticky" x-data="{ open : false }">
        <div class="container mx-auto flex h-full justify-between">
          <div class="flex h-full items-center gap-6">
            <div class="mr-2 h-full">
              <a href="http://127.0.0.1:5173/" class="inline-flex h-full items-center">
                <img src="../assets/atguigu.jpg" alt="Logo" class="h-full w-auto">
              </a>
            </div>
          
            <ul class="hidden items-center gap-8 sm:flex">
              <li class="relative text-sm" x-data="dropdown">
                <a class="text-gray-600" href="http://127.0.0.1:5173/">首页</a>  
              </li>
            </ul>
          </div>
        
          <div class="flex items-center">
              <a href="http://127.0.0.1:5173/#/login" title="发布博文" class="inline-flex h-full items-center">
                <img src="../assets/publish.jpg" alt="Logo" class="h-full w-auto">
                发布文章
              </a>
          </div>
        </div>
      </header>
  
      <section>
        <div class="bg-cover bg-center bg-no-repeat h-96" style="background-image: url(https://www.gulixueyuan.com/files/system/2023/04-04/150831f74f62589616.jpg);height:300px;">
        </div>
      </section>
      
      <section class="container mx-auto mt-6 grid grid-cols-4 gap-6">
        <div class="col-span-4 sm:col-span-3">
        <ul id="filters" class="flex flex-wrap gap-2">
          <li>
            <a href="http://127.0.0.1:5173/">
              <span class="truncate text-base"> 全部 </span>
            </a>
          </li>
        
          <li x-data="dropdown" class="relative cursor-pointer transition-all">
            <a href="http://127.0.0.1:5173/">
            <span class="truncate text-base">默认分类</span>
            </a>
          </li>
          
          <li x-data="dropdown" class="relative cursor-pointer transition-all">
            <a href="http://127.0.0.1:5173/">
            <span class="truncate text-base">MySQL</span>
            </a>
          </li>
  
          <li x-data="dropdown" class="relative cursor-pointer transition-all">
            <a href="http://127.0.0.1:5173/">
            <span class="truncate text-base">vue</span>
            </a>
          </li>
        </ul>
  
        <div id="post-list" class="mt-6 grid grid-cols-1 gap-6  md:grid-cols-2">
          <div class="overflow-hidden rounded-xl bg-white shadow-md  hover:-translate-y-1 hover:ring-2 ">
            <div class="aspect-w-16 aspect-h-9">
            <a href="http://127.0.0.1:5173/#/detail" title="【spring MVC】">
              <img src="https://www.gulixueyuan.com/files/course/2021/08-02/151735f51c11714475.png" class="h-full w-full object-cover transition-all duration-500 group-hover:scale-105">
            </a>
            </div>
            <div class="relative flex flex-col gap-2 p-4">
            <h1 class="text-2xl font-medium">
              <a href="http://127.0.0.1:5173/#/detail" title="【spring MVC】">【spring MVC】</a>
            </h1>
            <p class="font-sm font-light line-clamp-6">Spring MVC属于SpringFrameWork的后续产品，已经融合在Spring Web Flow里面。Spring 框架提供了构建 Web 应用程序的全功能 MVC 模块。使用 Spring 可插入的 MVC 架构，从而在使用Spring进行WEB开发时，可以选择使用Spring的Spring MVC框架或集成其他MVC开发框架</p>
            <div class="mt-4 flex flex-1 items-center">
              <a href="http://127.0.0.1:5173/#/detail">
              <img src="../assets/atguigu.jpg" class="h-8 w-8 dark:border-slate-700">
              </a>
              <span class="text-sm text-gray-600">发布于 2023-06-26</span>
            </div>
            </div>
          </div>
            
          <div class="overflow-hidden rounded-xl bg-white shadow-md  hover:-translate-y-1 hover:ring-2 ">
            <div class="aspect-w-16 aspect-h-9">
            <a href="http://127.0.0.1:5173/#/detail" title="【spring MVC】">
              <img src="https://www.gulixueyuan.com/files/course/2021/08-02/151735f51c11714475.png" class="h-full w-full object-cover transition-all duration-500 group-hover:scale-105">
            </a>
            </div>
            <div class="relative flex flex-col gap-2 p-4">
            <h1 class="text-2xl font-medium">
              <a href="http://127.0.0.1:5173/#/detail" title="【spring MVC】">【spring MVC】</a>
            </h1>
            <p class="font-sm font-light line-clamp-6">Spring MVC属于SpringFrameWork的后续产品，已经融合在Spring Web Flow里面。Spring 框架提供了构建 Web 应用程序的全功能 MVC 模块。使用 Spring 可插入的 MVC 架构，从而在使用Spring进行WEB开发时，可以选择使用Spring的Spring MVC框架或集成其他MVC开发框架</p>
            <div class="mt-4 flex flex-1 items-center">
              <a href="http://127.0.0.1:5173/#/detail">
              <img src="../assets/atguigu.jpg" class="h-8 w-8 dark:border-slate-700">
              </a>
              <span class="text-sm text-gray-600">发布于 2023-06-26</span>
            </div>
            </div>
          </div>
        </div>
      </div>
        
      <aside class="col-span-1 flex-col gap-6 sm:flex">
        <div class="bg-white p-3 shadow transition-all">
          <div class="flex flex-col items-center ">
          <div class="relative h-24 w-24">
            <img src="../assets/01.jpg" alt="Java程序员" class="h-full w-full rounded-full">
          </div>
          <div><h1 class="text-2xl">Java程序员</h1></div>
          
          <div class="grid grid-cols-4 gap-5">
            <div class="inline-flex flex-col items-center">
            <span class="text-xl">33</span>
            <span class="text-xs">文章数</span>
            </div>
            <div class="inline-flex flex-col items-center">
            <span class="text-xl">26</span>
            <span class="text-xs">分类数</span>
            </div>
          
            <div class="inline-flex flex-col items-center">
            <span class="text-xl">23403</span>
            <span class="text-xs">访问量</span>
            </div>
          </div>
          </div>
        </div>
  
        <div class="bg-white p-3 shadow">
          <h2>
            <span class="text-lg"></span>
            热门文章
          </h2>
        <div>
          <ul role="list">
            <li class="py-3">
              <div class="flex items-center">
                <div class="flex flex-col gap-1">
                  <h3 >
                    <a href="#" title="【MyBatis】MyBatis 和 Hibernate">【MyBatis】MyBatis 和 Hibernate</a>
                  </h3>
                  <p>2023-06-26 发布</p>
                </div>
              </div>
            </li>
            <li class="py-3">
              <div class="flex items-center">
                <div class="flex flex-col gap-1">
                  <h3>
                    <a href="#" title="【对比】Native ui 和 Element Plus">【【对比】Native ui 和 Element Plus</a>
                  </h3>
                  <p>2023-06-13 发布</p>
                </div>
              </div>
            </li>
            <li class="py-3">
              <div class="flex items-center">
                <div class="flex flex-col gap-1">
                  <h3 >
                    <a href="#" title="【毕业季】毕业设计指南">【毕业季】毕业设计指南</a>
                  </h3>
                  <p>2023-05-23 发布</p>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      </aside>
      </section>
    </div>
  </template>
  
  <style lang="scss" scoped>
  .login-panel {
      width: 500px;
      margin: 0 auto;
      margin-top: 130px;
  }
  </style>
```

#### （2）Detail.vue

文章详情页面

```vue
<template>
    <div>
      <header id="header-menu" class="sticky top-0 z-10 flex h-14 bg-white py-3 menu-sticky" x-data="{ open : false }">
        <div class="container mx-auto flex h-full justify-between">
          <div class="flex h-full items-center gap-6">
            <div class="mr-2 h-full">
              <a href="http://127.0.0.1:5173/" class="inline-flex h-full items-center">
                <img src="../assets/atguigu.jpg" alt="Logo" class="h-full w-auto">
              </a>
            </div>
          
            <ul class="hidden items-center gap-8 sm:flex">
              <li class="relative text-sm" x-data="dropdown">
                <a class="text-gray-600" href="http://127.0.0.1:5173/">首页</a>  
              </li>
            </ul>
          </div>
        
          <div class="flex items-center">
              <a href="http://127.0.0.1:5173/#/login" title="发布博文" class="inline-flex h-full items-center">
                <img src="../assets/publish.jpg" alt="Logo" class="h-full w-auto">
                发布文章
              </a>
          </div>
        </div>
      </header>
      
      <section class="container mx-auto mt-6 grid grid-cols-4 gap-6">
        <div class="col-span-4 sm:col-span-3">
  
      <div x-data="postUpvote" class="rounded-xl bg-white p-4 dark:bg-slate-800">
        <div class="flex items-center justify-between">
          <div class="inline-flex items-center justify-start gap-2">
            <div class="flex flex-col gap-0.5">
              <a href="https://www.javadog.net/authors/hdxjhkhjc2012" title="Java程序员" class="text-sm font-semibold text-gray-900 hover:text-gray-600 dark:text-slate-100 dark:hover:text-slate-200">Java程序员</a>
              <div class="flex items-center gap-2 text-xs font-light text-gray-600 dark:text-slate-100">
                <span>发布于 2023-05-23</span>
              </div>
            </div>
          </div>
          
        </div>
        <h1 class="my-3 text-2xl font-medium dark:text-slate-50">【毕业季】毕业设计避坑指南</h1>
        
        <article id="content" class="prose prose-base mt-4 !max-w-none prose-pre:p-0 dark:prose-invert break-words"><h2 id="前言">前言</h2>
  
        <h4 id="毕业季，毕业设计分手季">毕业季，毕业设计分手季</h4>
        <p>每年到了初夏的季节，校园美好青春即将落幕。然而挡在毕业前的最大的障碍不是<strong>分手</strong>，而是<strong>毕业设计和毕业答辩</strong>。有些同学可能会对<strong>毕业设计无从下手</strong>，从而<strong>盲目选题</strong>，或者听从网上购买毕设导致被欺骗，最终<strong>影响毕业</strong>。本狗深知其中套路，特来献出<strong>避坑指南</strong>，希望略尽绵薄之力，帮助学子们跨过深坑。</p>
        </article>
      </div>
  
      </div>
        
      <aside class="col-span-1 flex-col gap-6 sm:flex">
        <div class="bg-white p-3 shadow transition-all">
          <div class="flex flex-col items-center ">
          <div class="relative h-24 w-24">
            <img src="../assets/01.jpg" alt="Java程序员" class="h-full w-full rounded-full">
          </div>
          <div><h1 class="text-2xl">Java程序员</h1></div>
          
          <div class="grid grid-cols-4 gap-5">
            <div class="inline-flex flex-col items-center">
            <span class="text-xl">33</span>
            <span class="text-xs">文章数</span>
            </div>
            <div class="inline-flex flex-col items-center">
            <span class="text-xl">26</span>
            <span class="text-xs">分类数</span>
            </div>
          
            <div class="inline-flex flex-col items-center">
            <span class="text-xl">23403</span>
            <span class="text-xs">访问量</span>
            </div>
          </div>
          </div>
        </div>
  
        <div class="bg-white p-3 shadow">
          <h2>
            <span class="text-lg"></span>
            热门文章
          </h2>
        <div>
          <ul role="list">
            <li class="py-3">
              <div class="flex items-center">
                <div class="flex flex-col gap-1">
                  <h3 >
                    <a href="#" title="【MyBatis】MyBatis 和 Hibernate">【MyBatis】MyBatis 和 Hibernate</a>
                  </h3>
                  <p>2023-06-26 发布</p>
                </div>
              </div>
            </li>
            <li class="py-3">
              <div class="flex items-center">
                <div class="flex flex-col gap-1">
                  <h3>
                    <a href="#" title="【对比】Native ui 和 Element Plus">【【对比】Native ui 和 Element Plus</a>
                  </h3>
                  <p>2023-06-13 发布</p>
                </div>
              </div>
            </li>
            <li class="py-3">
              <div class="flex items-center">
                <div class="flex flex-col gap-1">
                  <h3 >
                    <a href="#" title="【毕业季】毕业设计指南">【毕业季】毕业设计指南</a>
                  </h3>
                  <p>2023-05-23 发布</p>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      </aside>
      </section>
    </div>
  </template>
```

#### （3）Login.vue

发布文章需要登录后台，是登录页面

```vue
<template>
  <div class="login">
    <el-form class="form" :model="user" :rules="formRules" ref="userForm">
      <h1 class="title">微博客后台管理系统</h1>
      <el-form-item prop="username">
        <el-input
          class="text"
          v-model="user.username"
          prefix-icon="User"
          clearable
          placeholder="用户名"
        />
      </el-form-item>
      <el-form-item prop="password">
        <el-input
          class="text"
          v-model="user.password"
          prefix-icon="Lock"
          show-password
          clearable
          placeholder="密码"
        />
      </el-form-item>
      <el-form-item>
        <el-button
          :loading="loading"
          type="primary"
          class="btn"
          size="large"
          @click="loginUser"
        >
          登录
        </el-button>
      </el-form-item>
    </el-form>
  </div>
</template>
  
<script setup>
  import { ref , onMounted } from 'vue';
  import { useRouter, useRoute } from 'vue-router'
  const router = useRouter()
  const route = useRoute()
  
  const defaultForm = {
      username: "",
      password: ""
  }
  
  const user = ref(defaultForm) 
  
  const userForm = ref(null)
  
  //分页数据
  const pageParamsForm = {
      username: [
          { required: true, message: "请输入账号", trigger: "blur" },
          { min: 3, max: 12, message: "账号长度在 3 到 12 个字符", trigger: "blur" },
      ],
      password: [
          { required: true, message: "请输入密码", trigger: "blur" },
          { min: 6, max: 18, message: "密码长度在 6 到 18 个字符", trigger: "blur" },
      ],
  }
  const formRules = ref(pageParamsForm) 

  const loginUser = () => {
    router.push("/dashboard/article")
  }
</script>
  
<style lang="scss" scoped>
  .login {
    transition: transform 1s;
    transform: scale(1);
    width: 100%;
    height:600px;
      margin: 0 auto;
    overflow: hidden;
    background: #2d3a4b;
  .form {
    width: 520px;
    max-width: 100%;
    padding: 0 24px;
    box-sizing: border-box;
    margin: 160px auto 0;
    :deep {
      .el-input__wrapper {
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
        background: rgba(0, 0, 0, 0.1);
      }
      .el-input-group--append > .el-input__wrapper {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }
      .el-input-group--prepend > .el-input__wrapper {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
      }
    }
    .title {
      color: #fff;
      text-align: center;
      font-size: 24px;
      margin: 0 0 24px;
    }
    .text {
      font-size: 16px;
      :deep(.el-input__inner) {
        color: #fff;
        height: 48px;
        line-height: 48px;
        &::placeholder {
          color: rgba(255, 255, 255, 0.2);
        }
      }
    }
    .btn {
      width: 100%;
    }
    }
  }
</style>
```

#### （4）Dashboard.vue

后台系统的主界面

```vue
<template>
    <div class="main-panel">
        <div class="menus">
            当前用户：
            <el-button type="primary">
                {{name}}
            </el-button>
            
            <div v-for="(menu, index) in menus" @click="toPage(menu)">
                {{ menu.name }}
            </div>
            
        </div>
        <div style="padding:20px;width:80%">
            <router-view></router-view>
        </div>
    </div>
    <div class="title">后台管理系统</div>
</template>

<script setup>
import { ref, reactive, inject, onMounted, computed } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import cookie from 'js-cookie'

const router = useRouter()
const route = useRoute()

// 分类列表
const props = [
    { name: "文章管理", href: "/dashboard/article" },
    { name: "分类管理", href: "/dashboard/category" },
    { name: "用户中心", href: "/dashboard/user" },
    { name: "退出", href: "logout" },
]
const menus = ref(props)

const name = ref(null)

onMounted(() => {
    getName()
})

const getName = ()=>{
    name.value = cookie.get('name')
    // if(!name.value) {
    //     router.push("/login")
    // }
}

const toPage = (menu) => {
    if (menu.href == 'logout') {
        router.push("/login")
    } else {
        let paths = menu.href;
        router.push(paths)
    }
}
</script>

<style lang="scss" scoped>
.main-panel {
    display: flex;
    color: #64676a;
    max-width: 100%;
}

.menus {
    line-height: 55px;
    text-align: center;
    width: 20%;
    height: 100%vh;
    border-right: 2px solid #dadada;
    cursor: pointer;
}

.title {
    font-size: 65px;
    font-weight: bold;
    text-align: right;
    position: fixed;
    color: rgba(0, 0, 0, 20%);
    right: calc((100vw - 1500px) / 2);
    bottom: 20px;
}
</style>
```

#### （5）Article.vue

文章管理页面，包含文章列表、添加、查看和删除

```vue
<template>
    <div class="search-div">

        <!-- 添加按钮 -->
        <div class="tools-div">
            <el-button type="success" size="small" @click="addShow">添 加</el-button>
        </div>
        
        <!--- 角色表格数据 -->
        <el-table :data="list" style="width: 100%">
            <el-table-column prop="id" label="文章ID" width="180" />
            <el-table-column prop="title" label="文章标题" width="180" />
            <el-table-column prop="createTime" label="发布时间" />
            <el-table-column label="操作" align="center" width="280" #default="scope">
                <el-button type="primary" size="small" @click="show(scope.row)">
                    查看
                </el-button>
                <el-button type="danger" size="small" @click="deleteById(scope.row)">
                    删除
                </el-button>
            </el-table-column>
        </el-table>

        <el-dialog v-model="dialogVisible" title="添加或修改文章" width="60%">
            <el-form label-width="100px">
            <el-form-item label="文章标题">
                <el-input v-model="article.title"/>
            </el-form-item>

            <el-form-item label="所属分类">
                <el-select
                class="m-2"
                v-model="article.cid"
                placeholder="选择分类"
                size="small"
                style="width: 100%"
                >
                <el-option
                    v-for="item in categoryList"
                    :key="item.id"
                    :label="item.cname"
                    :value="item.cid"
                />
                </el-select>
          </el-form-item>

            <el-form-item label="文章内容">
                <rich-text-editor v-model="article.content"></rich-text-editor>
            </el-form-item>

            <el-form-item>
                <el-button type="primary" @click="submit">提交</el-button>
                <el-button @click="dialogVisible = false">取消</el-button>
            </el-form-item>
            </el-form>
        </el-dialog>

        <el-dialog v-model="dialogShowVisible" title="文章详情" width="60%">
            <el-tag>{{article.title}}</el-tag>
            <div v-html="article.content"></div>
        </el-dialog>

  </div>

</template>

<script setup>
import { ref , onMounted } from 'vue';
import { ElMessage, ElMessageBox } from 'element-plus'
import RichTextEditor from '../../components/RichTextEditor.vue'

const categoryList = ref([])
// 定义表格数据模型
let list = ref([])

// 控制对话是否展示的变量
const dialogVisible = ref(false)
const dialogShowVisible = ref(false)
const defaultForm = {
    id: "",
    cid:"",
    title: "",
    content:""
}
const article = ref(defaultForm)   // 使用ref包裹该对象，使用reactive不方便进行重置

</script>

<style scoped>

.search-div {
  margin-bottom: 10px;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}

.tools-div {
  margin: 10px 0;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}

</style>
```

#### （6）Category.vue

分类管理页面，包含列表、添加、修改、删除

```vue
<template>
    <div class="search-div">
        <!-- 搜索表单 -->
        <el-form label-width="70px" size="small">
            <el-form-item label="分类名称">
                <el-input
                v-model="queryDto.cname"
                style="width: 100%"
                placeholder="角色名称"
                ></el-input>
            </el-form-item>
            <el-row style="display:flex">
                <el-button type="primary" size="small" @click="searchCategory">
                搜索
                </el-button>
                <el-button size="small" @click="resetData">重置</el-button>
            </el-row>
        </el-form>

        <!-- 添加按钮 -->
        <div class="tools-div">
            <el-button type="success" size="small" @click="addShow">添 加</el-button>
        </div>
        
        <!--- 角色表格数据 -->
        <el-table :data="list" style="width: 100%">
            <el-table-column prop="cid" label="分类id" width="180" />
            <el-table-column prop="cname" label="分类名称" width="180" />
            <el-table-column prop="createTime" label="创建时间" />
            <el-table-column label="操作" align="center" width="280" #default="scope">
                <el-button type="primary" size="small" @click="editShow(scope.row)">
                    修改
                </el-button>
                <el-button type="danger" size="small" @click="deleteById(scope.row)">
                    删除
                </el-button>
            </el-table-column>
        </el-table>

        <!--分页条-->
        <el-pagination
            v-model:current-page="pageParams.page"
            v-model:page-size="pageParams.limit"
            @size-change="fetchData"
            @current-change="fetchData"
            layout="total, prev, pager, next"
            :total="total"
        />

        <el-dialog v-model="dialogVisible" title="添加或修改" width="30%">
            <el-form label-width="120px">
            <el-form-item label="分类名称">
                <el-input v-model="category.cname"/>
            </el-form-item>
            <el-form-item>
                <el-button type="primary" @click="submit">提交</el-button>
                <el-button @click="dialogVisible = false">取消</el-button>
            </el-form-item>
            </el-form>
        </el-dialog>
  </div>

</template>

<script setup>
import { ref , onMounted } from 'vue';
import { ElMessage, ElMessageBox } from 'element-plus'

// 分页条总记录数
let total = ref(0)

//分页数据
const pageParamsForm = {
  page: 1, // 页码
  limit: 2, // 每页记录数
}
const pageParams = ref(pageParamsForm)     // 将pageParamsForm包装成支持响应式的对象

// 定义表格数据模型
let list = ref([])

// 搜索表单数据
const queryDto = ref({"cname": ""})

// 控制对话是否展示的变量
const dialogVisible = ref(false)
const defaultForm = {
    cid: "",
    cname: ""
}
const category = ref(defaultForm)   // 使用ref包裹该对象，使用reactive不方便进行重置

</script>

<style scoped>

.search-div {
  margin-bottom: 10px;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}

.tools-div {
  margin: 10px 0;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}

</style>
```

#### （7）User.vue

```vue
<template>
    <div class="login-panel">
        <el-form :rules="formRules" :model="userInfo" ref="userForm">
            <el-form-item path="username" label="账号">
                <el-input :disabled="true" v-model="userInfo.username" placeholder="请输入账号" />
            </el-form-item>
            <el-form-item path="password" label="密码">
                <el-input :disabled="true" v-model="userInfo.password" type="password" placeholder="请输入密码" />
            </el-form-item>
            <el-form-item path="phone" label="手机号">
                <el-input v-model="userInfo.phone" placeholder="请输入手机号" />
            </el-form-item>

            <el-form-item path="introduction" label="简介">
                <el-input
                v-model="userInfo.introduction"
                placeholder="个人简介"
                type="textarea"
                :autosize="{
                    minRows: 3,
                    maxRows: 5
                }"
                />
            </el-form-item> 

            <el-form-item>
                <el-button type="error" @click="modifyUser">
                修改
                </el-button>
            </el-form-item> 
        </el-form>
    </div>
</template>

<script setup>
import { ref, reactive, inject, onMounted, computed } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { ElMessage, ElMessageBox } from 'element-plus'

const router = useRouter()
const route = useRoute()

// 分类列表
const props = {
  uid:null,
  username:'',
  password:'',
  phone:'',
  introduction:''
};
const userInfo = ref(props)

</script>

<style lang="scss" scoped>
.login-panel {
    width: 400px;
    margin: 0;
}
</style>
```



## 4 搭建后端环境

### 4.1 创建工程

![image-20230627215944838](img\image-20230627215944838.png)



### 4.2 引入依赖

在blog_project引入依赖

```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>3.0.5</version>
</parent>

<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
        <groupId>org.mybatis.spring.boot</groupId>
        <artifactId>mybatis-spring-boot-starter</artifactId>
        <version>3.0.1</version>
    </dependency>

    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>8.0.30</version>
    </dependency>
</dependencies>
```



### 4.3 创建数据库和表

![image-20230625110247990](img\image-20230625110247990.png)

```sql
/*
SQLyog Ultimate - MySQL GUI v8.2 
MySQL - 8.0.30 : Database - blog
*********************************************************************
*/


/*!40101 SET NAMES utf8 */;

/*!40101 SET SQL_MODE=''*/;

/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;
CREATE DATABASE /*!32312 IF NOT EXISTS*/`blog` /*!40100 DEFAULT CHARACTER SET utf8mb3 */ /*!80016 DEFAULT ENCRYPTION='N' */;

USE `blog`;

/*Table structure for table `article` */

DROP TABLE IF EXISTS `article`;

CREATE TABLE `article` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `title` varchar(100) DEFAULT NULL,
  `content` text,
  `cid` bigint DEFAULT NULL,
  `uid` bigint DEFAULT NULL,
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=28 DEFAULT CHARSET=utf8mb3;

/*Data for the table `article` */

insert  into `article`(`id`,`title`,`content`,`cid`,`uid`,`create_time`,`update_time`) values (9,'Spring轻量级框架','spring',2,1,'2023-06-28 12:27:41','2023-06-28 12:27:41'),(11,'Vue前端框架','vue',2,1,'2023-06-28 12:30:17','2023-06-28 12:30:17'),(19,'Java','java',3,1,'2023-07-11 20:20:45','2023-07-11 20:20:45'),(27,'9999',NULL,NULL,NULL,'2023-07-12 14:12:11','2023-07-12 14:12:11');

/*Table structure for table `category` */

DROP TABLE IF EXISTS `category`;

CREATE TABLE `category` (
  `cid` bigint NOT NULL AUTO_INCREMENT,
  `cname` varchar(100) DEFAULT NULL,
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`cid`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8mb3;

/*Data for the table `category` */

insert  into `category`(`cid`,`cname`,`create_time`,`update_time`) values (2,'java','2023-06-28 09:59:54','2023-06-28 09:49:54'),(3,'mysql','2023-06-28 09:50:03','2023-06-28 09:50:03'),(9,'vue','2023-07-11 20:28:31','2023-07-11 20:28:31');

/*Table structure for table `user` */

DROP TABLE IF EXISTS `user`;

CREATE TABLE `user` (
  `uid` bigint NOT NULL AUTO_INCREMENT,
  `username` varchar(20) DEFAULT NULL,
  `password` varchar(20) DEFAULT NULL,
  `phone` varchar(20) DEFAULT NULL,
  `introduction` varchar(255) DEFAULT NULL,
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb3;

/*Data for the table `user` */

insert  into `user`(`uid`,`username`,`password`,`phone`,`introduction`,`create_time`,`update_time`) values (1,'lucy','123456','13567890987','334666777','2023-06-28 10:31:48','2023-06-28 10:31:48'),(2,'1','1','1','1','2023-07-11 20:37:19','2023-07-11 20:37:19');

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
```



### 4.4 创配置文件

application.properties

```properties
server.port=8001

spring.datasource.url=jdbc:mysql://localhost:3306/blog
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.type=com.zaxxer.hikari.HikariDataSource

mybatis.mapper-locations=classpath:/mapper/*.xml
mybatis.configuration.map-underscore-to-camel-case=true

spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=GMT+8
```



### 4.5 创建启动类

```java
package com.atguigu.blog;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class BlogApplication {

    public static void main(String[] args) {
        SpringApplication.run(BlogApplication.class,args);
    }
}
```



### 4.6 创建实体类

![image-20230627220850377](img\image-20230627220850377.png)

#### （1）文章实体类：Article

```java
package com.atguigu.blog.entity;

import java.util.Date;

public class Article {
    
    private Long id;
    private String title; //文章标题
    private String content; //文章内容
    private Long cid; //分类id
    private Long uid; //用户id
    private Date create_time;
    private Date update_time;

    public Long getId() {
        return id;
    }
    public void setId(Long id) {
        this.id = id;
    }
    public String getTitle() {
        return title;
    }
    public void setTitle(String title) {
        this.title = title;
    }
    public String getContent() {
        return content;
    }
    public void setContent(String content) {
        this.content = content;
    }
    public Long getCid() {
        return cid;
    }
    public void setCid(Long cid) {
        this.cid = cid;
    }
    public Long getUid() {
        return uid;
    }
    public void setUid(Long uid) {
        this.uid = uid;
    }
    public Date getCreate_time() {
        return create_time;
    }
    public void setCreate_time(Date create_time) {
        this.create_time = create_time;
    }
    public Date getUpdate_time() {
        return update_time;
    }
    public void setUpdate_time(Date update_time) {
        this.update_time = update_time;
    }
}
```

#### （2）分类实体类：Category

```java
package com.atguigu.blog.entity;

import java.util.Date;

public class Category {
    
    private Long cid;
    private String cname; //分类名称
    private Date create_time;
    private Date update_time;

    public Long getCid() {
        return cid;
    }
    public void setCid(Long cid) {
        this.cid = cid;
    }
    public String getCname() {
        return cname;
    }
    public void setCname(String cname) {
        this.cname = cname;
    }
    public Date getCreate_time() {
        return create_time;
    }
    public void setCreate_time(Date create_time) {
        this.create_time = create_time;
    }
    public Date getUpdate_time() {
        return update_time;
    }
    public void setUpdate_time(Date update_time) {
        this.update_time = update_time;
    }
}
```

#### （3）用户实体类：User

```java
package com.atguigu.blog.entity;

import java.util.Date;

public class User {
    
    private Long uid; //用户id
    private String username;//用户名称
    private String password;//密码
    private String phone;//手机号
    private String introduction;//个人介绍
    private Date create_time;
    private Date update_time;

    public Long getUid() {
        return uid;
    }
    public void setUid(Long uid) {
        this.uid = uid;
    }
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }
    public String getPhone() {
        return phone;
    }
    public void setPhone(String phone) {
        this.phone = phone;
    }
    public String getIntroduction() {
        return introduction;
    }
    public void setIntroduction(String introduction) {
        this.introduction = introduction;
    }
    public Date getCreate_time() {
        return create_time;
    }
    public void setCreate_time(Date create_time) {
        this.create_time = create_time;
    }
    public Date getUpdate_time() {
        return update_time;
    }
    public void setUpdate_time(Date update_time) {
        this.update_time = update_time;
    }
}
```



### 4.7 创建controller

![image-20230627222230344](img\image-20230627222230344.png)



### 4.8 创建service

![image-20230627222549996](img\image-20230627222549996.png)



### 4.9 创建mapper

#### （1）创建mapper接口

![image-20230627222756719](img\image-20230627222756719.png)

#### （2）创建mapper映射文件

![image-20230627222922940](img\image-20230627222922940.png)

### 4.10 统一结果返回类

项目中我们会将响应封装成json返回，一般我们会将所有接口的数据格式统一， 使前端(iOS Android, Web)对数据的操作更一致、轻松。

一般情况下，统一返回数据格式没有固定的格式，只要能描述清楚返回的数据状态以及要返回的具体数据就可以。但是一般会包含状态码、返回消息、数据这几部分内容

例如，我们的系统要求返回的基本数据格式如下：

**列表：**

```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "id": 1,
    "title": "java开发",
    "content": "java是面向对象语言",
    "cid": 3,
    "uid": 1
  },
  "ok": true
}
```

**分页：**

```json
{
  "code": 200,
  "message": "成功",
  "data": {
    "total": 3,
    "list": [
      {
        "id": 1,
        "title": "java开发",
        "content": "java是面向对象语言",
        "cid": 3,
        "uid": 1
      },
      {
        "id": 2,
        "title": "spring",
        "content": "spring是一款轻量级框架",
        "cid": 1,
        "uid": 10
      }
    ]
  },
  "ok": true
}
```

**没有返回数据：**

```json
{
  "code": 200,
  "message": "成功",
  "data": null,
  "ok": true
}
```

**失败：**

```json
{
  "code": 201,
  "message": "失败",
  "data": null,
  "ok": false
}
```



#### （1）统一返回结果状态类 

```java
package com.atguigu.blog.utils;

import lombok.Getter;

/**
 * 统一返回结果状态信息类
 *
 */
@Getter
public enum ResultCodeEnum {

    SUCCESS(200,"成功"),
    FAIL(201, "失败"),
    ;

    private Integer code;
    private String message;
    private ResultCodeEnum(Integer code, String message) {
        this.code = code;
        this.message = message;
    }
}
```



#### （2）创建统一返回结果类

```java
package com.atguigu.blog.utils;

import lombok.Data;

/**
 * 全局统一返回结果类
 *
 */
@Data
public class Result<T> {

    private Integer code;

    private String message;

    private T data;

    public Result(){}

    // 返回数据
    protected static <T> Result<T> build(T data) {
        Result<T> result = new Result<T>();
        if (data != null)
            result.setData(data);
        return result;
    }

    public static <T> Result<T> build(T body, Integer code, String message) {
        Result<T> result = build(body);
        result.setCode(code);
        result.setMessage(message);
        return result;
    }

    public static <T> Result<T> build(T body, ResultCodeEnum resultCodeEnum) {
        Result<T> result = build(body);
        result.setCode(resultCodeEnum.getCode());
        result.setMessage(resultCodeEnum.getMessage());
        return result;
    }

    public static<T> Result<T> ok(){
        return Result.ok(null);
    }

    /**
     * 操作成功
     * @param data  baseCategory1List
     * @param <T>
     * @return
     */
    public static<T> Result<T> ok(T data){
        Result<T> result = build(data);
        return build(data, ResultCodeEnum.SUCCESS);
    }

    public static<T> Result<T> fail(){
        return Result.fail(null);
    }

    /**
     * 操作失败
     * @param data
     * @param <T>
     * @return
     */
    public static<T> Result<T> fail(T data){
        Result<T> result = build(data);
        return build(data, ResultCodeEnum.FAIL);
    }

    public Result<T> message(String msg){
        this.setMessage(msg);
        return this;
    }

    public Result<T> code(Integer code){
        this.setCode(code);
        return this;
    }

    public boolean isOk() {
        if(this.getCode().intValue() == ResultCodeEnum.SUCCESS.getCode().intValue()) {
            return true;
        }
        return false;
    }
}
```



## 5 后端接口-文章管理

### 5.1 文章列表

#### （1）ArticleController

```java
package com.atguigu.blog.controller;

import com.atguigu.blog.entity.Article;
import com.atguigu.blog.service.ArticleService;
import com.atguigu.blog.utils.Result;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.Map;

@RestController
@RequestMapping("/article")
public class ArticleController {

    @Autowired
    private ArticleService articleService;

    //文章列表
    @PostMapping("queryList")
    public Result articleList(@RequestBody(required = false) Article article) {
        List<Article> list  = articleService.list(article);
        return Result.ok(list);
    }
}
```

#### （2）ArticleService

```java
package com.atguigu.blog.service;

import com.atguigu.blog.entity.Article;

import java.util.Map;

public interface ArticleService {
    //文章列表
    List<Article> list(Article article);
}
```

#### （3）ArticleServiceImpl

```java
package com.atguigu.blog.service.impl;

import com.atguigu.blog.entity.Article;
import com.atguigu.blog.mapper.ArticleMapper;
import com.atguigu.blog.service.ArticleService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Service
public class ArticleServiceImpl implements ArticleService {

    @Autowired
    private ArticleMapper articleMapper;

    //文章列表
    @Override
    public List<Article> list(Article article) {
        List<Article> list = articleMapper.selectList(article);
        return list;
    }
}
```

#### （4）ArticleMapper

```java
package com.atguigu.blog.mapper;

import com.atguigu.blog.entity.Article;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
@Mapper
public interface ArticleMapper {

    //查询文章列表集合
    List<Article> selectList(@Param("vo") Article article);
}
```

#### （5）ArticleMapper.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atguigu.blog.mapper.ArticleMapper">

    <!--查询数据list集合-->
    <select id="selectList" resultType="com.atguigu.blog.entity.Article">
        select * from article
        <where>
            <if test="vo.cid != null and vo.cid !=0">
                cid=#{vo.cid}
            </if>
        </where>
    </select>
</mapper>
```



### 5.2 文章添加

#### （1）添加Controller方法

```java
//添加文章
@PostMapping("addArticle")
public Result addArticle(@RequestBody Article article) {
    articleService.insert(article);
    return Result.ok();
}
```

#### （2）添加Service方法

```java
//添加文章
void insert(Article article);
```

#### （3）添加Service实现方法

```java
//添加文章
@Override
public void insert(Article article) {
    articleMapper.insertArticle(article);
}
```

#### （4）添加Mapper方法

```java
//添加文章
void insertArticle(Article article);
```

#### （4）编写xml文件

```xml
<insert id="insertArticle">
	insert into article(title,content,cid,uid) values(#{title},#{content},#{cid},#{uid})
</insert>
```



### 5.3 文章修改

#### （1）添加Controller方法

```java
//根据id查询
@GetMapping("getArticle/{id}")
public Result getArticle(@PathVariable Long id) {
    Article article = articleService.get(id);
    return Result.ok(article);
}

//修改文章
@PutMapping("updateArticle")
public Result updateArticle(@RequestBody Article article) {
    articleService.update(article);
    return Result.ok();
}
```

#### （2）添加Service方法

```java
//根据id查询
Article get(Long id);

//修改文章
void update(Article article);
```

#### （3）添加Service实现方法

```java
//根据id查询
@Override
public Article get(Long id) {
    return articleMapper.getArticle(id);
}

//修改文章
@Override
public void update(Article article) {
    articleMapper.updateArticle(article);
}
```

#### （4）添加Mapper方法

```java
//根据id查询
Article getArticle(Long id);

//修改文章
void updateArticle(Article article);
```

#### （4）编写xml文件

```xml
<!--根据id查询-->
<select id="getArticle" resultType="com.atguigu.blog.entity.Article">
    select * from article where id=#{id}
</select>

<!--//修改文章-->
<update id="updateArticle" parameterType="com.atguigu.blog.entity.Article">
    update article set title=#{title},content=#{content},cid=#{cid} where id=#{id}
</update>
```



### 5.4 文章删除

#### （1）添加Controller方法

```java
//删除文章
@DeleteMapping("deleteArticle/{id}")
public Result deleteArticle(@PathVariable Long id) {
    articleService.delete(id);
    return Result.ok();
}
```

#### （2）添加Service方法

```java
//删除文章
void delete(Long id);
```

#### （3）添加Service实现方法

```java
//删除文章
@Override
public void delete(Long id) {
    articleMapper.deleteArticle(id);
}
```

#### （4）添加Mapper方法

```java
//删除文章
void deleteArticle(Long id);
```

#### （4）编写xml文件

```xml
<!--删除文章-->
<delete id="deleteArticle">
    delete from article where id=#{id}
</delete>
```



### 5.5 整合Swagger

#### 5.5.1 Swagger

Swagger是一种基于OpenAPI规范的API文档生成工具，它可以根据Java代码中的注解自动生成API接口文档，并提供UI界面进行在线测试和调试。

Swagger为开发人员提供了更加方便、直观的API管理方式，有助于提升API的可读性和可维护性。

Swagger的主要特点包括：

1、自动生成API文档：通过在Java代码中添加Swagger注解，Swagger能够自动地解析API接口的参数、响应等信息，并生成相应的API文档。

2、在线测试接口：Swagger提供了UI界面，可以方便地进行API接口的测试和调试，无需单独使用HTTP客户端来测试接口。

3、支持多种语言和框架：Swagger不仅支持Java语言和Spring框架，还支持多种其他语言和框架，如PHP、Python、Go等。

4、扩展性强：Swagger提供了多种扩展机制和插件，可以满足各种项目的需要，如集成OAuth2、自定义UI等。

Swagger提供的UI界面相比于另外一款Api文档生成工具**Knife4j**较为简陋。

#### 5.5.2 Knife4j

官方文档：https://doc.xiaominfo.com/

Knife4j是一种基于Swagger构建的增强工具，它在Swagger的基础上增加了更多的功能和扩展，提供了更加丰富的API文档管理功能。相比于原版

Swagger，Knife4j的主要特点包括：

1、更加美观的UI界面：Knife4j通过对Swagger UI的修改和优化，实现了更加美观、易用的UI界面，提升了开发人员的体验感。

2、支持多种注解配置方式：除了支持原版Swagger的注解配置方式外，Knife4j还提供了其他几种注解配置方式，如@ApiIgnore、

@ApiOperationSupport等，方便开发人员进行不同场景

下的配置。

3、提供多种插件扩展：Knife4j提供了多种插件扩展，如knife4j-auth、knife4j-rate-limiter等，可以满足不同项目的需求。

4、集成Spring Boot Starter：Knife4j发布了spring-boot-starter-knife4j，可以实现更加便捷的集成，并支持配置文件中的动态属性调整。

官方文档使用地址：https://doc.xiaominfo.com/docs/quick-start

##### （1）引入依赖

在项目的pom.xml文件中加入如下依赖：

```xml
<dependency>
    <groupId>com.github.xiaoymin</groupId>
    <artifactId>knife4j-openapi3-jakarta-spring-boot-starter</artifactId>
    <version>4.1.0</version>
</dependency>
```

##### （2）添加knife4j的配置类

```java
package com.atguigu.blog.config;

import io.swagger.v3.oas.models.OpenAPI;
import io.swagger.v3.oas.models.info.Contact;
import io.swagger.v3.oas.models.info.Info;
import org.springdoc.core.models.GroupedOpenApi;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class Knife4jConfig {

    @Bean
    public GroupedOpenApi adminApi() {      // 创建了一个api接口的分组
        return GroupedOpenApi.builder()
                .group("admin-api")         // 分组名称
                .pathsToMatch("/**")  // 接口请求路径规则
                .build();
    }

    /***
     * @description 自定义接口信息
     */
    @Bean
    public OpenAPI customOpenAPI() {

        return new OpenAPI()
                .info(new Info()
                        .title("微博客API接口文档")
                        .version("1.0")
                        .description("微博客API接口文档")
                        .contact(new Contact().name("atguigu"))); // 设定作者
    }

}
```

##### （3）接口测试

启动项目就可以访问到knife4j所生成的接口文档了。访问地址：http://localhost:8001/doc.html

![image-20230711192210508](img\image-20230711192210508.png)

##### （4）常见注解

在Knife4j中也提供了一些注解，让我们对接口加以说明，常见的注解如下所示：

```shell
@Tag： 用在controller类上，对controller进行说明
@Operation: 用在controller接口方法上对接口进行描述
@Parameters：用在controller接口方法上对单个参数进行描述
@Schema： 用在实体类和实体类属性上，对实体类以及实体类属性进行描述
```

举例说明：

```java
@Tag(name = "首页接口")
public class IndexController {


    @Operation(summary = "用户登录")
    public Result<LoginVo> login(@RequestBody LoginDto loginDto) {
        ...
    }

    @Operation(summary = "用户退出")
    @Parameters(value = {
            @Parameter(name = "令牌参数" , required = true)
    })
    @GetMapping(value = "/logout")
    public Result logout(@RequestHeader(value = "token") String token) {
        ...
    }

}

@Data
@Schema(description = "用户登录请求参数")
public class Login {

    @Schema(description = "用户名")
    private String userName ;

    @Schema(description = "密码")
    private String password ;

}
```



## 6 跨域请求

### 6.1 跨域请求简介

跨域请求：通过一个域的JavaScript脚本和另外一个域的内容进行交互

域的信息：协议、域名、端口号

![image-20230507150620790](img\image-20230507150620790.png) 

同域：当两个域的协议、域名、端口号均相同

如下所示：

![image-20230507150506550](img\image-20230507150506550.png) 

**同源【域】策略**：在浏览器中存在一种安全策略就是同源策略，同源策略（Sameoriginpolicy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。可以说Web是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现。同源策略会阻止一个域的javascript脚本和另外一个域的内容进行交互。



### 6.2 解决跨域

后端服务器开启跨域支持：

在Controller上添加**@CrossOrigin**注解

```java
@RestController
@RequestMapping(value = "/XXXX")
@CrossOrigin
public class XXXXController {

}
```



## 7 后端接口-分类管理

### 7.1 编写Controller

```java
package com.atguigu.blog.controller;

import com.atguigu.blog.entity.Category;
import com.atguigu.blog.service.CategoryService;
import com.atguigu.blog.utils.Result;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import java.util.List;
import java.util.Map;

@RestController
@RequestMapping("/category")
@CrossOrigin
public class CategoryController {

    @Autowired
    private CategoryService categoryService;

    //分类列表
    @PostMapping("queryList")
    public Result articleList() {
        List<Category> list = categoryService.list();
        return Result.ok(list);
    }

    //条件分页查询
    @PostMapping("queryListPage/{current}/{limit}")
    public Result queryListPage(@PathVariable Long current,
                                @PathVariable Long limit,
                                @RequestBody(required = false) Category category) {
        Map<String,Object> data = categoryService.queryPage(current,limit,category);
        return Result.ok(data);
    }

    //添加分类
    @PostMapping("addCategory")
    public Result addCategory(@RequestBody Category category) {
        categoryService.insert(category);
        return Result.ok();
    }

    //根据id查询
    @GetMapping("getCategory/{id}")
    public Result getCategory(@PathVariable Long id) {
        Category category = categoryService.get(id);
        return Result.ok(category);
    }
    //修改分类
    @PutMapping("updateCategory")
    public Result updateCategory(@RequestBody Category category) {
        categoryService.update(category);
        return Result.ok();
    }

    //删除分类
    @DeleteMapping("deleteCategory/{id}")
    public Result deleteCategory(@PathVariable Long id) {
        categoryService.delete(id);
        return Result.ok();
    }
}
```



### 7.2 编写Service

```java
package com.atguigu.blog.service;

import com.atguigu.blog.entity.Category;

import java.util.List;
import java.util.Map;

public interface CategoryService {

    //分类列表
    List<Category> list();

    //添加分类
    void insert(Category category);

    //根据id查询
    Category get(Long id);

    //修改分类
    void update(Category category);

    //删除分类
    void delete(Long id);

    //条件分页查询
    Map<String, Object> queryPage(Long current, Long limit, Category category);
}
```



### 7.3 编写Service实现

```java
package com.atguigu.blog.service.impl;

import com.atguigu.blog.entity.Article;
import com.atguigu.blog.entity.Category;
import com.atguigu.blog.mapper.ArticleMapper;
import com.atguigu.blog.mapper.CategoryMapper;
import com.atguigu.blog.service.CategoryService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Service
public class CategoryServiceImpl implements CategoryService {

    @Autowired
    private CategoryMapper categoryMapper;

    //分类列表
    @Override
    public List<Category> list() {
        List<Category> list = categoryMapper.selectList();
        return list;
    }

    //添加分类
    @Override
    public void insert(Category category) {
        categoryMapper.insertCategory(category);
    }

    //根据id查询
    @Override
    public Category get(Long id) {
        return categoryMapper.getCategory(id);
    }

    //修改分类
    @Override
    public void update(Category category) {
        categoryMapper.updateCategory(category);
    }

    //删除分类
    @Override
    public void delete(Long id) {
        categoryMapper.deleteCategory(id);
    }

    //条件分页查询
    @Override
    public Map<String, Object> queryPage(Long current, Long limit, Category category) {
        //查询总记录数
        Long total = categoryMapper.selectCount(category);

        //分页条件查询
        Long begin = (current-1)*limit;
        List<Category> list = categoryMapper.pageList(begin,limit,category);

        //封装
        Map<String, Object> map = new HashMap<>();
        map.put("total",total);
        map.put("list",list);
        return map;
    }
}
```



### 7.4 编写Mapper

```java
package com.atguigu.blog.mapper;

import com.atguigu.blog.entity.Article;
import com.atguigu.blog.entity.Category;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.springframework.stereotype.Repository;

import java.util.List;

@Repository
@Mapper
public interface CategoryMapper {

    //查询数据list集合
    List<Category> selectList();

    //添加分类
    void insertCategory(Category category);

    //根据id查询
    Category getCategory(Long cid);

    //修改分类
    void updateCategory(Category category);

    //删除分类
    void deleteCategory(Long cid);

    //总记录数
    Long selectCount(Category category);

    //条件分页查询
    List<Category> pageList(@Param("begin") Long begin,
                            @Param("limit") Long limit,
                            @Param("vo") Category category);
}
```



### 7.5 编写Mapper映射文件

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atguigu.blog.mapper.CategoryMapper">

    <!--查询数据list集合-->
    <select id="selectList" resultType="com.atguigu.blog.entity.Category">
        select * from category
    </select>

    <!--查询总记录数-->
    <select id="selectCount" resultType="Long">
        select count(*) from category
        <where>
            <if test="cname!=null and cname!=''">
                cname = #{cname}
            </if>
        </where>
    </select>

    <!--条件分页查询-->
    <select id="pageList" resultType="com.atguigu.blog.entity.Category">
        select * from category
        <where>
            <if test="vo.cname!=null and vo.cname!=''">
                cname = #{vo.cname}
            </if>
        </where>
        limit #{begin},#{limit}
    </select>

    <!--//添加分类-->
    <insert id="insertCategory" parameterType="com.atguigu.blog.entity.Category">
        insert into category(cname) values(#{cname})
    </insert>

    <!--根据id查询-->
    <select id="getCategory" resultType="com.atguigu.blog.entity.Category">
        select * from category where cid=#{cid}
    </select>

    <!--//修改分类-->
    <update id="updateCategory" parameterType="com.atguigu.blog.entity.Category">
        update category set cname=#{cname} where cid=#{cid}
    </update>

    <!--删除分类-->
    <delete id="deleteCategory">
        delete from category where cid=#{cid}
    </delete>
</mapper>
```



## 8 后端接口-用户操作接口

### 8.1 用户登录接口

#### （1）编写UserController

```java
package com.atguigu.blog.controller;

import com.atguigu.blog.entity.User;
import com.atguigu.blog.service.UserService;
import com.atguigu.blog.utils.Result;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/user")
public class UserController {

    @Autowired
    private UserService userService;

    //登录
    @PostMapping("login")
    public Result loginUser(@RequestBody User user) {
        User userExist = userService.login(user);
        if(userExist != null) {
            Map<String,Object> map = new HashMap<>();
            map.put("name",userExist.getUsername());
            map.put("uid",userExist.getUid());
            return Result.ok(map);
        } else {
            return Result.fail();
        }
    }
}
```

#### （2）编写UserService

```java
package com.atguigu.blog.service;

import com.atguigu.blog.entity.User;

public interface UserService {
    //登录
    User login(User user);
}
```

#### （3）编写UserService实现

```java
package com.atguigu.blog.service.impl;

import com.atguigu.blog.entity.User;
import com.atguigu.blog.mapper.UserMapper;
import com.atguigu.blog.service.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class UserServiceImpl implements UserService {

    @Autowired
    private UserMapper userMapper;

    //登录
    //根据用户名查询密码，比较输入密码和数据库密码是否一致
    @Override
    public User login(User user) {
        User selectUser = userMapper.loginUser(user.getUsername());
        if(selectUser != null) {
            String inputPass = user.getPassword();
            String databasePass = selectUser.getPassword();
            if(!inputPass.equals(databasePass)) {
                return null;
            }
            return selectUser;
        }
        return null;
    }
}
```

#### （4）编写UserMapper

```java
package com.atguigu.blog.mapper;

import com.atguigu.blog.entity.User;
import org.apache.ibatis.annotations.Mapper;
import org.springframework.stereotype.Repository;

@Repository
@Mapper
public interface UserMapper {

    //登录
    User loginUser(String username);
}
```

#### （5）编写UserMapper.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atguigu.blog.mapper.UserMapper">

    <!--//登录-->
    <select id="loginUser" resultType="com.atguigu.blog.entity.User">
        select * from user where username=#{username}
    </select>
</mapper>
```



### 8.2 用户注册接口

#### （1）编写Controller

```java
//注册
@PostMapping("register")
public Result registerUser(@RequestBody User user) {
    boolean flag = userService.register(user);
    if(flag) {
        return Result.ok();
    } else {
        return Result.fail();
    }
}
```

#### （2）编写Service

```java
//注册
boolean register(User user);
```

#### （3）编写Service实现

```java
//注册
@Override
public boolean register(User user) {
    //根据用户名查询，如果存在相同的，不能注册
    User selectUser = userMapper.loginUser(user.getUsername());
    if(selectUser == null) {
        //注册
        userMapper.insertUser(user);
        return true;
    }
    return false;
}
```

#### （4）编写Mapper

```java
//注册
void insertUser(User user);
```

#### （5）编写Mapper映射文件

```xml
<!--//注册-->
<insert id="insertUser">
    insert into user(username,password,phone,introduction) values(#{username},#{password},#{phone},#{introduction})
</insert>
```



### 8.3 用户修改接口

#### （1）编写Controller

```java
//根据id查询
@GetMapping("getUser/{id}")
public Result getUser(@PathVariable Long id) {
    User user = userService.get(id);
    return Result.ok(user);
}

//修改
@PutMapping("updateUser")
public Result updateUser(@RequestBody User user) {
    userService.update(user);
    return Result.ok();
}
```

#### （2）编写Service

```java
//根据id查询
User get(Long id);

//修改
void update(User user);
```

#### （3）编写Service实现

```java
//根据id查询
@Override
public User get(Long id) {
    return userMapper.getUser(id);
}

//修改
@Override
public void update(User user) {
    userMapper.updateUser(user);
}
```

#### （4）编写Mapper

```java
//根据id查询
User getUser(Long id);

//修改
void updateUser(User user);
```

#### （5）编写Mapper映射文件

```xml
<!--根据id查询-->
<select id="getUser" resultType="com.atguigu.blog.entity.User">
    select * from user where uid=#{id}
</select>

<!--修改-->
<update id="updateUser">
    update user set phone=#{phone},introduction=#{introduction} where uid=#{uid}
</update>
```



## 9 统一异常处理

### 9.1 制造异常

除以0

```java
int a = 10/0;
```

 出现500错误提示

```json
{
  "timestamp": "2023-07-10 11:32:33",
  "status": 500,
  "error": "Internal Server Error",
  "path": "/article/getAllData"
}
```

我们想让异常结果也显示为统一的返回结果对象，并且统一处理系统的异常信息，那么需要统一异常处理



### 9.2 创建统一异常处理器

创建统一异常处理类ExceptionOperation.java：

```java
import com.atguigu.blog.utils.Result;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;

@ControllerAdvice
public class ExceptionOperation {

    @ExceptionHandler(Exception.class)
    @ResponseBody
    public Result error(Exception e) {
        e.printStackTrace();
        return Result.fail().message("出错了...");
    }
}

```

### 9.3 测试 

返回统一错误结果

```json
{
  "code": 201,
  "message": "出错了...",
  "data": null
}
```



## 10 前后端功能整合

### 10.1 定义接口信息

#### （1）在api目录下创建js文件

![image-20230628203700334](img\image-20230628203700334.png)

#### （2）article.js

定义文章相关接口信息，包含接口路径、提交方式、参数信息

```js
import request from '../utils/axios.js'

// 列表
export const listArticle = (article) => {
    return request({
        url: `/article/queryList`,
        method: 'post',
        data: article
    })
}

// 新增
export const addArticle = (article) => {
    return request({
        url: "/article/addArticle",
        method: "post",
        data: article
    })
}

// 根据id查询
export const getArticle = (id) => {
    return request({
        url: `/article/getArticle/${id}`,
        method: "get"
    })
}

// 修改
export const updateArticle = (article) => {
    return request({
        url: "/article/updateArticle",
        method: "put",
        data: article
    })
}

// 删除
export const deleteArticle = (id) => {
    return request({
        url: `/article/deleteArticle/${id}`,
        method: "delete"
    })
}
```

#### （3）category.js

定义分类相关接口信息，包含接口路径、提交方式、参数信息

```javascript
import request from '../utils/axios.js'

// 分类列表
export const listCategory = () => {
    return request({
        url: `/category/queryList`,
        method: 'post'
    })
}

// 条件分页分类列表
export const listCategoryPage = (current,limit,category) => {
    return request({
        url: `/category/queryListPage/${current}/${limit}`,
        method: 'post',
        data: category
    })
}

// 新增
export const addCategory = (category) => {
    return request({
        url: "/category/addCategory",
        method: "post",
        data: category
    })
}

// 根据id查询
export const getCategory = (id) => {
    return request({
        url: `/category/getCategory/${id}`,
        method: "get"
    })
}

// 修改
export const updateCategory = (category) => {
    return request({
        url: "/category/updateCategory",
        method: "put",
        data: category
    })
}

// 删除
export const deleteCategory = (id) => {
    return request({
        url: `/category/deleteCategory/${id}`,
        method: "delete"
    })
}
```

#### （4）user.js

定义用户相关接口信息，包含接口路径、提交方式、参数信息

```js
import request from '../utils/axios.js'

// 登录
export const login = (user) => {
    return request({
        url: `/user/login`,
        method: 'post',
        data: user
    })
}

// 注册
export const register = (user) => {
    return request({
        url: "/user/register",
        method: "post",
        data: user
    })
}

// 根据id查询
export const getUser = (id) => {
    return request({
        url: `/user/getUser/${id}`,
        method: "get"
    })
}

// 修改
export const updateUser = (user) => {
    return request({
        url: "/user/updateUser",
        method: "put",
        data: user
    })
}
```



### 10.2 前台-文章和分类列表

#### （1）在HomePage.vue实现调用

```vue
<script setup>
import { ref, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { listArticle , addArticle , getArticle , updateArticle , deleteArticle } from '../api/article';
import { listCategory } from '../api/category';

const router = useRouter()

//定义分类和文章集合
const categoryList = ref([])
const articleList = ref([])

//定义分类id查询条件
const prop = {
    cid: null
}
const categoryData = ref(prop) 

//钩子函数
onMounted(() => {
    getCategortyList(),
    getArticleList()
})

//页面跳转到文章详情页面
const showArticle = (id) => {
    router.push({ path: "/detail",query:{id:id}})
}

//根据分类查询文章
const selectArticle = (cid) => {
    categoryData.value.cid = cid
    getArticleList()
}

//查询所有分类
const getCategortyList = async () => {
    const { data } = await listCategory()
    categoryList.value = data
}

//查询所有文章
const getArticleList = async () => {
    const { data } = await listArticle(categoryData.value)
    articleList.value = data
}
</script>
```

#### （2）在HomePage.vue处理页面

* 显示所有分类

```vue
<li v-for="(category, index)  in categoryList" x-data="dropdown" class="relative cursor-pointer transition-all">
  <a href="#" @click="selectArticle(category.cid)">
  <span class="truncate text-base">{{category.cname}}</span>
  </a>
</li>
```

* 显示所有文章

```vue
<div v-for="article in articleList" class="overflow-hidden rounded-xl bg-white shadow-md  hover:-translate-y-1 hover:ring-2 ">
  <div  @click="showArticle(article.id)" class="aspect-w-16 aspect-h-9">
      <img src="https://www.gulixueyuan.com/files/course/2021/08-02/151735f51c11714475.png" class="h-full w-full object-cover transition-all duration-500 group-hover:scale-105">
  </div>

  <div class="relative flex flex-col gap-2 p-4">
      <h1 @click="showArticle(article.id)">
        {{article.title}}
      </h1>
      <p class="font-sm font-light line-clamp-6 dark:text-slate-200"
         v-html="article.content"></p>
      <div class="mt-4 flex flex-1 items-center justify-start gap-2">
        <a href="#" >
          <img src="../assets/atguigu.jpg"  class="h-8 w-8 dark:border-slate-700">
        </a>
        <span class="text-sm text-gray-600">发布于 {{article.createTime}}</span>
      </div>
  </div>
</div>
```



### 10.3 前台-文章详情

#### （1）添加详情跳转方法

```vue
<h1 @click="showArticle(article.id)">
	{{article.title}}
</h1>
```

#### （2）实现详情跳转方法

```js
//页面跳转到文章详情页面
const showArticle = (id) => {
    router.push({ path: "/detail",query:{id:id}})
}
```

#### （3）Detail.vue编写调用

```vue
<script setup>
import { ref, onMounted } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { getArticle } from '../api/article';

const router = useRouter()
const route = useRoute()

// 文章详情
const props = {
  id:'',
  title:'',
  content:''
};
const articleInfo = ref(props)

onMounted(() => {
    loadArticle()
})

/**
 * 读取文章详情
 */
const loadArticle = async () => {
    let id = route.query.id
    const { data } = await getArticle(id)
    articleInfo.value = data
}
</script>
```

#### （4）Detail.vue编写页面显示

```vue
......
<span>发布于 {{articleInfo.createTime}}</span>
......
</div>
<h1 class="my-3 text-2xl font-medium dark:text-slate-50">{{articleInfo.title}}</h1>
<hr>
<h2 v-html="articleInfo.content"></h2>
<hr>
```



### 10.4 用户登录

#### （1）Login.vue编写调用

```vue
<template>
  <div class="login">
    <el-form class="form" :model="user" :rules="formRules" ref="userForm">
      <h1 class="title">微博客后台管理系统</h1>
      <el-form-item prop="username">
        <el-input
          class="text"
          v-model="user.username"
          prefix-icon="User"
          clearable
          placeholder="用户名"
        />
      </el-form-item>
      <el-form-item prop="password">
        <el-input
          class="text"
          v-model="user.password"
          prefix-icon="Lock"
          show-password
          clearable
          placeholder="密码"
        />
      </el-form-item>
      <el-form-item>
        <el-button
          :loading="loading"
          type="primary"
          class="btn"
          size="large"
          @click="loginUser"
        >
          登录
        </el-button>
      </el-form-item>
    </el-form>
  </div>
</template>

<script setup>
import { ref , onMounted } from 'vue';
import { useRouter, useRoute } from 'vue-router'
const router = useRouter()
const route = useRoute()
import cookie from 'js-cookie'
import { login } from '../api/user';

const defaultForm = {
    username: "",
    password: ""
}

const user = ref(defaultForm) 
const userForm = ref(null)

//分页数据
const pageParamsForm = {
    username: [
        { required: true, message: "请输入账号", trigger: "blur" },
        { min: 3, max: 12, message: "账号长度在 3 到 12 个字符", trigger: "blur" },
    ],
    password: [
        { required: true, message: "请输入密码", trigger: "blur" },
        { min: 6, max: 18, message: "密码长度在 6 到 18 个字符", trigger: "blur" },
    ],
}
const formRules = ref(pageParamsForm) 

const loginUser = async () => {
    const valid = await userForm.value.validate()
    if(valid) {
        const {data} = await login(user.value) 
        setCookies(data.name, data.uid)
        router.push("/dashboard/article")
    } 
}

const setCookies = (name, uid) => {
    cookie.set('uid', uid, { path: '/' })
    cookie.set('name', name, { path: '/' })
}
</script>

<style lang="scss" scoped>
.login {
  transition: transform 1s;
  transform: scale(1);
  width: 100%;
  height:600px;
    margin: 0 auto;
  overflow: hidden;
  background: #2d3a4b;
  .form {
    width: 520px;
    max-width: 100%;
    padding: 0 24px;
    box-sizing: border-box;
    margin: 160px auto 0;
    :deep {
      .el-input__wrapper {
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
        background: rgba(0, 0, 0, 0.1);
      }
      .el-input-group--append > .el-input__wrapper {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }
      .el-input-group--prepend > .el-input__wrapper {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
      }
    }
    .title {
      color: #fff;
      text-align: center;
      font-size: 24px;
      margin: 0 0 24px;
    }
    .text {
      font-size: 16px;
      :deep(.el-input__inner) {
        color: #fff;
        height: 48px;
        line-height: 48px;
        &::placeholder {
          color: rgba(255, 255, 255, 0.2);
        }
      }
    }
    .btn {
      width: 100%;
    }
  }
}
</style>
```

#### （2）编写Dashboard.vue页面

```vue
<template>
    <div class="main-panel">
        <div class="menus">
            当前用户：
            <n-button strong secondary type="primary">
                {{name}}
            </n-button>
            
            <div v-for="(menu, index) in menus" @click="toPage(menu)">
                {{ menu.name }}
            </div>
            
        </div>
        <div style="padding:20px;width:80%">
            <router-view></router-view>
        </div>
    </div>
    <div class="title">后台管理系统</div>
</template>

<script setup>
import { ref, reactive, inject, onMounted, computed } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import cookie from 'js-cookie'

const router = useRouter()
const route = useRoute()

// 分类列表
const props = [
    { name: "文章管理", href: "/dashboard/article" },
    { name: "分类管理", href: "/dashboard/category" },
    { name: "用户中心", href: "/dashboard/user" },
    { name: "退出", href: "logout" },
]
const menus = ref(props)

const name = ref(null)

onMounted(() => {
    getName()
})

const getName = ()=>{
    name.value = cookie.get('name')
    if(!name.value) {
        router.push("/login")
    }
}

const toPage = (menu) => {
    if (menu.href == 'logout') {
        router.push("/login")
    } else {
        let paths = menu.href;
        router.push(paths)
    }
}
</script>

<style lang="scss" scoped>
.main-panel {
    display: flex;
    color: #64676a;
    max-width: 100%;
}
.menus {
    line-height: 55px;
    text-align: center;
    width: 20%;
    height: 100%vh;
    border-right: 2px solid #dadada;
    cursor: pointer;
}
.title {
    font-size: 65px;
    font-weight: bold;
    text-align: right;
    position: fixed;
    color: rgba(0, 0, 0, 20%);
    right: calc((100vw - 1500px) / 2);
    bottom: 20px;
}
</style>
```



### 10.5 文章管理

#### （1）编写Article.vue页面

```vue
<template>
    <div class="search-div">
        <!-- 添加按钮 -->
        <div class="tools-div">
            <el-button type="success" size="small" @click="addShow">添 加</el-button>
        </div>
        <!--- 角色表格数据 -->
        <el-table :data="list" style="width: 100%">
            <el-table-column prop="id" label="文章ID" width="180" />
            <el-table-column prop="title" label="文章标题" width="180" />
            <el-table-column prop="createTime" label="发布时间" />
            <el-table-column label="操作" align="center" width="280" #default="scope">
                <el-button type="primary" size="small" @click="show(scope.row)">
                    查看
                </el-button>
                <el-button type="danger" size="small" @click="deleteById(scope.row)">
                    删除
                </el-button>
            </el-table-column>
        </el-table>
        <el-dialog v-model="dialogVisible" title="添加或修改文章" width="60%">
            <el-form label-width="100px">
            <el-form-item label="文章标题">
                <el-input v-model="article.title"/>
            </el-form-item>

            <el-form-item label="所属分类">
                <el-select
                class="m-2"
                v-model="article.cid"
                placeholder="选择分类"
                size="small"
                style="width: 100%"
                >
                <el-option
                    v-for="item in categoryList"
                    :key="item.id"
                    :label="item.cname"
                    :value="item.cid"
                />
                </el-select>
          </el-form-item>
            <el-form-item label="文章内容">
                <rich-text-editor v-model="article.content"></rich-text-editor>
            </el-form-item>
            <el-form-item>
                <el-button type="primary" @click="submit">提交</el-button>
                <el-button @click="dialogVisible = false">取消</el-button>
            </el-form-item>
            </el-form>
        </el-dialog>
        <el-dialog v-model="dialogShowVisible" title="文章详情" width="60%">
            <el-tag>{{article.title}}</el-tag>
            <div v-html="article.content"></div>
        </el-dialog>
  </div>
</template>

<script setup>
import { ref , onMounted } from 'vue';
import { listArticle , addArticle , getArticle , updateArticle , deleteArticle } from '../../api/article';
import { ElMessage, ElMessageBox } from 'element-plus'
import RichTextEditor from '../../components/RichTextEditor.vue'
import { listCategory , addCategory , getCategory , updateCategory , deleteCategory } from '../../api/category';

const categoryList = ref([])
// 定义表格数据模型
let list = ref([])

// 控制对话是否展示的变量
const dialogVisible = ref(false)
const dialogShowVisible = ref(false)
const defaultForm = {
    id: "",
    cid:"",
    title: "",
    content:""
}
const article = ref(defaultForm)   // 使用ref包裹该对象，使用reactive不方便进行重置

// 页面加载完毕以后请求后端接口获取数据
onMounted(() => {
    fetchData()
    getCategortyList()
})

// 远程调用后端分页查询接口
const fetchData = async () => {
    const {data , code , message } = await listArticle(article.value) ;
    list.value = data;
}

//查询所有分类
const getCategortyList = async () => {
    const { data  } = await listCategory()
    categoryList.value = data
}

//进入添加
const addShow = () => {
    article.value = {}
  dialogVisible.value = true
  
}

// 添加
const submit = async () => {
    if(!article.value.id) {
        const { code } = await addArticle(article.value) ;
        article.value.cid=null
        dialogVisible.value = false
        ElMessage.success('操作成功')
        fetchData()
    }else {
        console.log(article.value)
        const { code } = await updateArticle(article.value) ;
        dialogVisible.value = false
        ElMessage.success('操作成功')
        fetchData()
    }
}

// 修改按钮点击事件处理函数
const show = (row) => {
    getDetail(row.id)
    dialogShowVisible.value = true
}

const getDetail = async (id) => {
    const {data , code , message } = await getArticle(id) ;
    article.value = data;
}

// 删除数据
const deleteById = (row) => {
    ElMessageBox.confirm('此操作将永久删除该记录, 是否继续?', 'Warning', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning',
    }).then(async () => {
        const {code } = await deleteArticle(row.id)
        ElMessage.success('删除成功')
        fetchData()
    })
}
</script>

<style scoped>
.search-div {
  margin-bottom: 10px;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}

.tools-div {
  margin: 10px 0;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}
</style>
```



### 10.6 分类管理

#### （1）编写Category.vue页面

```vue
<template>
    <div class="search-div">
        <!-- 搜索表单 -->
        <el-form label-width="70px" size="small">
            <el-form-item label="分类名称">
                <el-input
                v-model="queryDto.cname"
                style="width: 100%"
                placeholder="角色名称"
                ></el-input>
            </el-form-item>
            <el-row style="display:flex">
                <el-button type="primary" size="small" @click="searchCategory">
                搜索
                </el-button>
                <el-button size="small" @click="resetData">重置</el-button>
            </el-row>
        </el-form>
        <!-- 添加按钮 -->
        <div class="tools-div">
            <el-button type="success" size="small" @click="addShow">添 加</el-button>
        </div>        
        <!--- 角色表格数据 -->
        <el-table :data="list" style="width: 100%">
            <el-table-column prop="cid" label="分类id" width="180" />
            <el-table-column prop="cname" label="分类名称" width="180" />
            <el-table-column prop="createTime" label="创建时间" />
            <el-table-column label="操作" align="center" width="280" #default="scope">
                <el-button type="primary" size="small" @click="editShow(scope.row)">
                    修改
                </el-button>
                <el-button type="danger" size="small" @click="deleteById(scope.row)">
                    删除
                </el-button>
            </el-table-column>
        </el-table>
        <!--分页条-->
        <el-pagination
            v-model:current-page="pageParams.page"
            v-model:page-size="pageParams.limit"
            @size-change="fetchData"
            @current-change="fetchData"
            layout="total, prev, pager, next"
            :total="total"
        />
        <el-dialog v-model="dialogVisible" title="添加或修改" width="30%">
            <el-form label-width="120px">
            <el-form-item label="分类名称">
                <el-input v-model="category.cname"/>
            </el-form-item>
            <el-form-item>
                <el-button type="primary" @click="submit">提交</el-button>
                <el-button @click="dialogVisible = false">取消</el-button>
            </el-form-item>
            </el-form>
        </el-dialog>
  </div>
</template>

<script setup>
import { ref , onMounted } from 'vue';
import { listCategory , listCategoryPage, addCategory , getCategory , updateCategory , deleteCategory } from '../../api/category';
import { ElMessage, ElMessageBox } from 'element-plus'

// 分页条总记录数
let total = ref(0)

//分页数据
const pageParamsForm = {
  page: 1, // 页码
  limit: 2, // 每页记录数
}
const pageParams = ref(pageParamsForm)     // 将pageParamsForm包装成支持响应式的对象

// 定义表格数据模型
let list = ref([])

// 搜索表单数据
const queryDto = ref({"cname": ""})

// 控制对话是否展示的变量
const dialogVisible = ref(false)
const defaultForm = {
    cid: "",
    cname: ""
}
const category = ref(defaultForm)   // 使用ref包裹该对象，使用reactive不方便进行重置

// 页面加载完毕以后请求后端接口获取数据
onMounted(() => {
    fetchData() ;
})

// 搜索按钮点击事件处理函数
const searchCategory = () => {
    fetchData()
}

const resetData = () => {
    queryDto.value.cname = ""
    fetchData()
}

// 远程调用后端分页查询接口
const fetchData = async () => {
    const {data , code , message } = await listCategoryPage(pageParams.value.page , pageParams.value.limit , queryDto.value) ;
    list.value = data.list;
    total.value = data.totalCount
}

//进入添加
const addShow = () => {
  dialogVisible.value = true
  category.value = {}
}

// 添加
const submit = async () => {
    if(!category.value.cid) {
        const { code } = await addCategory(category.value) ;
        alert(code)
        dialogVisible.value = false
        ElMessage.success('操作成功')
        pageParams.value.page = 1
        fetchData()
    }else {
        console.log(category.value)
        const { code } = await updateCategory(category.value) ;
        dialogVisible.value = false
        ElMessage.success('操作成功')
        pageParams.value.page = 1
        fetchData()
    }
}

// 修改按钮点击事件处理函数
const editShow = (row) => {
    category.value = row
    dialogVisible.value = true
}

// 删除数据
const deleteById = (row) => {
    ElMessageBox.confirm('此操作将永久删除该记录, 是否继续?', 'Warning', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning',
    }).then(async () => {
        const {code } = await deleteCategory(row.cid)
        ElMessage.success('删除成功')
        pageParams.value.page = 1
        fetchData()
    })
}
</script>

<style scoped>
.search-div {
  margin-bottom: 10px;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}
.tools-div {
  margin: 10px 0;
  padding: 10px;
  border: 1px solid #ebeef5;
  border-radius: 3px;
  background-color: #fff;
}
</style>
```



### 10.7 用户中心

#### （1）编写User.vue页面

```vue
<template>
    <div class="login-panel">
        <el-card title="用户中心" class="bg-panel">
            <el-form :rules="formRules" :model="userInfo" ref="userForm">
                <el-form-item path="username" label="账号">
                    <el-input :disabled="true" v-model="userInfo.username" placeholder="请输入账号" />
                </el-form-item>
                <el-form-item path="password" label="密码">
                    <el-input :disabled="true" v-model="userInfo.password" type="password" placeholder="请输入密码" />
                </el-form-item>
                <el-form-item path="phone" label="手机号">
                    <el-input v-model="userInfo.phone" placeholder="请输入手机号" />
                </el-form-item>

                <el-form-item path="introduction" label="简介">
                    <el-input
                    v-model="userInfo.introduction"
                    placeholder="个人简介"
                    type="textarea"
                    :autosize="{
                        minRows: 3,
                        maxRows: 5
                    }"
                    />
                </el-form-item> 

                <el-form-item>
                    <el-button type="error" @click="modifyUser">
                    修改
                    </el-button>
                </el-form-item> 
            </el-form>
        </el-card>
    </div>
</template>

<script setup>
import { ref, reactive, inject, onMounted, computed } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { getUser,updateUser } from '../../api/user';
import { ElMessage, ElMessageBox } from 'element-plus'
import cookie from 'js-cookie'

const router = useRouter()
const route = useRoute()

// 分类列表
const props = {
  uid:null,
  username:'',
  password:'',
  phone:'',
  introduction:''
};
const userInfo = ref(props)

onMounted(() => {
    loadUser()
})


const loadUser = async () => {
    let uid= cookie.get('uid')
    const { data } = await getUser(uid)
    userInfo.value = data
}

const modifyUser = async () => {
    const { data } = await updateUser(userInfo.value)
    ElMessage.success('操作成功')
}
</script>

<style lang="scss" scoped>
.login-panel {
    width: 500px;
    margin: 0;
}
</style>
```

